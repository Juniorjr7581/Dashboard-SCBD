<head>
  <title>Monitoring CSC 2025</title>
  <link
    rel="icon"
    type="x-icon"
    href="https://lh3.googleusercontent.com/pw/AP1GczNzXltTdYmjKPMGA8w38Qw1ifkNiUgNUaYy8aiQZ-SNVKhukRLkd4O3-1FrjTAvHPHruS0aZ1ARiS-DtyB-1KIPWT8SMw7U61OsOUn8Dqnqsh3M_TT5Ow7ZwFIkGRXWxcASSNEW-Sstxx07SaXeUeQj=w32-h32-s-no-gm?authuser=0"
  />

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }

    #wrapper {
      transform-origin: top left;
      width: 1366px;
      height: 768px;
      transform: scale(1);
    }

    body {
      background-image: url("https://lh3.googleusercontent.com/pw/AP1GczO3Mo0eLOrt76Dz_gZBwBG8nZbQMCxJLIVQwzizOcf7Ov35PI32S4EKWDpSeRZZIlB9vgYvStk3vyaAIviY9CL1A-gQTuRFuRJiKLfFGiCJnIlTvfEshjrIv_Ri1QksFEpLPxpLva-roMbTZcbxahi-=w1366-h1000-s-no-gm?authuser=0");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
    }

    .chart-animate {
      animation: revealFromLeft 1s ease-in forwards;
      clip-path: inset(0 100% 0 0);
      opacity: 0;
    }

    @keyframes revealFromLeft {
      0% {
        clip-path: inset(0 100% 0 0);
        opacity: 0;
      }
      100% {
        clip-path: inset(0 0% 0 0);
        opacity: 1;
      }
    }
  </style>
</head>

<body>
  <div id="wrapper">
    <!-- Kutipan Motivasi -->
    <iframe
      id="Quotes"
      style="
        width: 300px;
        height: 200px;
        top: 90px;
        left: 132px;
        border: none;
        position: absolute;
      "
      scrolling="no"
      srcdoc='
    <!DOCTYPE html>
    <html>
      <head>
        <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
        <style>
          * { margin:0; padding:0; box-sizing:border-box; }
          body { font-family:"Dancing Script", cursive; text-align:center; background:transparent; }
          p { font-size:1.1rem; color:#555; word-break:break-word; }
          .author { font-size:1rem; font-weight:bold; color:#888; }
        </style>
      </head>
      <body>
        <p>"A company without a scorecard is like a ship without a compass — it moves, but it drifts."</p>
        <div class="author">— Anonymous</div>
      </body>
    </html>'
      allowtransparency="true"
    >
    </iframe>

    <div
      id="JudulDashboard"
      style="
        position: absolute;
        top: 4.3%;
        left: 50%;
        transform: translateX(-50%);
        font-family: Tahoma;
        font-size: 36px;
        font-weight: bold;
        color: white;
      "
    >
      MONITORING CSC 2025
    </div>

    <div
      id="PeriodeText"
      style="
        position: absolute;
        top: 10%;
        left: 50%;
        transform: translateX(-50%);
        font-family: Tahoma;
        font-size: 24px;
        font-weight: bold;
        color: white;
      "
    ></div>

    <!-- Grafik Current Month -->
    <iframe
      id="chartCurrentMonth"
      class="chart-animate"
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=201427233&format=interactive"
      style="
        width: 1358px;
        height: 501px;
        position: fixed;
        top: 125px;
        left: 20;
        border: 0;
        overflow: hidden;
        display: none;
      "
    ></iframe>

    <iframe
      id="chartCurrentMonthUnsort"
      class="chart-animate"
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=311350746&format=interactive"
      style="
        width: 1358px;
        height: 501px;
        position: fixed;
        top: 125px;
        left: 20;
        border: 0;
        overflow: hidden;
        display: none;
      "
    ></iframe>

    <!-- Grafik Latest Estimate -->
    <iframe
      id="chartLatestEstimate"
      class="chart-animate"
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=1024669901&format=interactive"
      style="
        width: 1358px;
        height: 501px;
        position: fixed;
        top: 125px;
        left: 20;
        border: 0;
        overflow: hidden;
        display: none;
      "
    ></iframe>

    <iframe
      id="chartLatestEstimateUnsort"
      class="chart-animate"
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=860980283&format=interactive"
      style="
        width: 1358px;
        height: 501px;
        position: fixed;
        top: 125px;
        left: 20;
        border: 0;
        overflow: hidden;
        display: none;
      "
    ></iframe>

    <!-- Tabel 3x1 di 1/3 bawah layar -->
    <div
      style="
        width: 93vw;
        height: 33.33vh;
        position: absolute;
        bottom: 5;
        left: 6vw;
        display: flex;
        gap: 1vw;
        font-family: Arial, sans-serif;
        font-size: 18px;
        font-weight: bold;
        color: white;
        text-align: center;
      "
    >
      <!-- Kolom kiri -->
      <div
        style="
          flex: 1;
          background-color: rgba(255, 255, 255, 0.2);
          border-radius: 25px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          overflow: hidden;
        "
      >
        <iframe
          width="100%"
          height="100%"
          seamless
          frameborder="0"
          scrolling="no"
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=564932292&amp;format=interactive"
        >
        </iframe>
      </div>

      <!-- Kolom tengah -->
      <div
        style="
          flex: 1;
          background-color: rgba(255, 255, 255, 0.2);
          border-radius: 25px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          overflow: hidden;
        "
      >
        <iframe
          width="100%"
          height="100%"
          seamless
          frameborder="0"
          scrolling="no"
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=997353705&format=interactive"
        >
        </iframe>
      </div>

      <!-- Kolom kanan -->
      <div
        style="
          flex: 1;
          background-color: rgba(255, 255, 255, 0.2);
          border-radius: 25px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          overflow: hidden;
        "
      >
        <iframe
          width="100%"
          height="100%"
          seamless
          frameborder="0"
          scrolling="no"
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKsAL1JLB6elNOj__dwpMnTXYHFX2rILhigq9kz3rvVykapxEh5FVmkF7PfQWTos3ZXbOn43q2GehD/pubchart?oid=2035768827&format=interactive"
        >
        </iframe>
      </div>
    </div>

    <div
      id="LabelTheme"
      class="chart-animate"
      style="
        display: none;
        position: absolute;
        top: 384px;
        left: 8.6%;
        font-family: Tahoma, sans-serif;
        font-size: 8px;
        background-color: rgba(255, 255, 255, 0.9);
        gap: 1px;
      "
    >
      <div
        style="
          width: 69px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #e53935;
          color: #fff;
        "
      >
        SAFETY & ENVIRONMENTAL
      </div>
      <div
        style="
          width: 102.5px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #1e88e5;
          color: #fff;
        "
      >
        FINANCIAL
      </div>
      <div
        style="
          width: 102.5px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #43a047;
          color: #fff;
        "
      >
        RELIABILITY PERFORMANCE
      </div>
      <div
        style="
          width: 207px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #fdd835;
          color: #000;
        "
      >
        COMPETITIVE EDGE
      </div>
      <div
        style="
          width: 101px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #8e24aa;
          color: #fff;
        "
      >
        DEVELOPMENT
      </div>
      <div
        style="
          width: 68px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #00acc1;
          color: #fff;
        "
      >
        MARKET GROWTH
      </div>
      <div
        style="
          width: 67px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #fb8c00;
          color: #fff;
        "
      >
        HUMAN CAPITAL
      </div>
      <div
        style="
          width: 67px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #5d4037;
          color: #fff;
        "
      >
        INFORMATION TECHNOLOGY
      </div>
      <div
        style="
          width: 32px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #3949ab;
          color: #fff;
        "
      >
        CERTIFI-CATION
      </div>
      <div
        style="
          width: 137px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #c0ca33;
          color: #000;
        "
      >
        SATISFACTION
      </div>
      <div
        style="
          width: 101px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #d81b60;
          color: #fff;
        "
      >
        REGULATOR & COMPLIANCE
      </div>
      <div
        style="
          width: 139px;
          height: 18px;
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          text-align: center;
          background-color: #6d4c41;
          color: #fff;
        "
      >
        PARTNERSHIP
      </div>
    </div>

    <!-- Jam Analog -->
    <iframe
      id="AnalogClock"
      style="
        width: 110px;
        height: 110px;
        top: 10px;
        left: 20px;
        position: absolute;
      "
      src="https://free.timeanddate.com/clock/i8kxjw6v/n108/szw110/szh110/hocfff/hbw2/cf100/hnc0096c8/fan3/fas22/fac900/fdi76/mqcfff/mql10/mqw4/mqd98/mhcfff/mhl10/mhw4/mhd98/mmcddd/mml10/mmw1/mmd98/hwm2/hhc00f/hmc009"
      frameborder="0"
      allowtransparency="true"
    >
    </iframe>

    <!-- Tanggal -->
    <iframe
      id="ShowDate"
      style="
        width: 450px;
        height: 30px;
        top: 5px;
        left: 50%;
        transform: translateX(-50%);
        position: absolute;
      "
      src="https://free.timeanddate.com/clock/i8kxmnu1/n108/tluk/fn2/fs16/fcfff/tct/pct/ftb/tt1"
      frameborder="0"
      allowtransparency="true"
    >
    </iframe>

    <!-- Logo -->
    <iframe
      id="LogoKCE"
      style="
        width: 300px;
        height: 83px;
        top: 20px;
        left: 1040px;
        position: absolute;
      "
      src="https://lh3.googleusercontent.com/pw/ADCreHdCRYm1obN2IoL9f95o8LImf1-TA7bm3JCdxfJrZbnwwClHyhMGJoyTrtrsk2VL6iXSMK-56SWkrckV0-R6fS6HWH98C4NQjWr5AS47mC1Hw11I8e1TZoGdLPMkbwgH37MS6PyrsWUv4dLKcNnyIFG2=w300-h83-s-no-gm?authuser=0"
      frameborder="0"
    >
    </iframe>

    <!-- Tulisan CORPORATE SCORECARD -->
    <iframe
      id="TextCORPORATESCORECARD"
      style="
        width: 102px;
        height: 650px;
        top: 115px;
        left: 8px;
        position: absolute;
        opacity: 0.25;
      "
      src="https://lh3.googleusercontent.com/pw/AP1GczPjE4QQw4cvnzmarbQT9OHQ6O6i1EGzmlchU_WdiaK5iJUwqcBbXOGDZ6_s_L1r-yQTt2vmYE-qMEkoJzVkdso2hZQz1WwLo-vl_CStOEdF7OqyCrU-D5YkuAvTjLWItQZj0v1EWtw_EUSt82-2iM9n=w68-h613-s-no-gm?authuser=0"
      frameborder="0"
    >
    </iframe>

    <!-- Tulisan ON TARGET -->
    <iframe
      id="TextONTARGET"
      style="
        width: 33px;
        height: 160px;
        top: 180px;
        left: 92px;
        position: absolute;
        opacity: 0.5;
        transform: scale(0.45);
        transform-origin: top left;
      "
      src="https://lh3.googleusercontent.com/pw/AP1GczNU9RrmWw7MVmSM7QtFaJReoFSs8SSUGEK5q1925EPS6U6yGR0416klZ6d-ictIBjrh8kKgXUcCIEkQ8XgaOHI-3WP7z7xutt46MIDDNIisyFrtw_FBN7p9QgTkvVaOXsE1bPmWy_qe3CVbPF5BEEAv=w33-h160-s-no-gm?authuser=0"
      frameborder="0"
    >
    </iframe>

    <!-- Tulisan THRESHOLD -->
    <iframe
      id="TextTHRESHOLD"
      style="
        width: 33px;
        height: 160px;
        top: 291px;
        left: 92px;
        position: absolute;
        opacity: 0.5;
        transform: scale(0.45);
        transform-origin: top left;
      "
      src="https://lh3.googleusercontent.com/pw/AP1GczMbodljDPJ6lbwq-7251bWuOqtqmRA5DUvJUxY5shCZLZsT0xWGDlek1Z-6HTzqQZilXXrQaY6OlbWOPV5NV_LkEV8T1NsOEruzig-buW2E3GQZbT3-Jcthifv61gwrCbrlIa2IObZ2dD7paaRhN6pL=w33-h160-s-no-gm?authuser=0"
      frameborder="0"
    >
    </iframe>

    <!-- Gambar Detail CSC -->
    <iframe
      id="DetailCSC"
      style="
        width: 1230px;
        height: 691px;
        top: 38px;
        left: 66px;
        display: none;
        position: fixed;
        opacity: 1;
        z-index: 999;
        border: none;
      "
      frameborder="0"
    ></iframe>

    <!-- Analyzer CSC -->
    <iframe
      id="AnalyzerCSC"
      style="
        width: 600px;
        height: 691px;
        top: 120px;
        left: 350px;
        display: none;
        position: fixed;
        opacity: 1;
        z-index: 999;
        border: 4px solid #000;
        background-color: #f7f7f7;
      "
      src="analyzer.html"
      frameborder="0"
    >
    </iframe>

    <!-- Gambar PIC -->
    <iframe
      id="PICCSC"
      style="
        width: 576px;
        height: 391px;
        top: 156px;
        left: 783px;
        display: none;
        position: absolute;
        opacity: 0.99;
      "
      src="https://lh3.googleusercontent.com/pw/AP1GczNE7zw56_S4lG9n-UvbdgDRslB4tOOfU5LMlKUA7H7JFgNIPsh-n4sKLxMGm0hvPRmZepipvl0cFFyrGgJy3oyu2QREBVOBcNucL-PSAXrreZdVwblA80FE6TWJfGEQQzmsUNdFhdU9wM1kTiNKj8Ou=w576-h391-s-no-gm?authuser=0"
      frameborder="0"
    >
    </iframe>

    <!-- Layer Transparan di Atas -->
    <iframe
      id="TopLayer"
      style="
        width: 100%;
        height: 100%;
        top: 0px;
        left: 0px;
        border: 0;
        position: absolute;
        background-color: #000;
        opacity: 0;
      "
    >
    </iframe>

    <!-- Dropdown Pilih Data -->
    <div
      style="
        position: absolute;
        top: 15%;
        left: 50%;
        transform: translateX(-50%);
        z-index: 999;
        font-family: Tahoma, sans-serif;
        font-size: 16px;
        color: white;
        display: flex;
        gap: 15px;
        white-space: nowrap;
        align-items: center;
      "
    >
      <input
        type="checkbox"
        id="sortScoreCheckbox"
        checked
        style="accent-color: red; margin-right: -10px"
      />SORT Low-High

      <select
        id="menuSelect"
        style="
          padding: 4px;
          border: 2px solid #007bff;
          border-radius: 8px;
          background: #fff;
          color: black;
          cursor: pointer;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        "
      >
        <option value="latest-estimate" selected>Data Latest Estimate</option>
        <option value="current-month">Data Year-To-Date</option>
        <option value="details">Details</option>
      </select>

      <button
        id="analyzeButton"
        style="
          color: white;
          padding: 6px 16px;
          border: none;
          border-radius: 8px;
          background: linear-gradient(to bottom, #34c759, #28a745);
          cursor: pointer;
          box-shadow: 0 4px #1e7e34;
          transition: all 0.1s ease-in-out;
          display: block;
        "
        onmousedown="this.style.boxShadow='0 2px #1e7e34'; this.style.transform='translateY(2px)';"
        onmouseup="this.style.boxShadow='0 4px #1e7e34'; this.style.transform='translateY(0)';"
      >
        Analyze
      </button>

      <input
        type="checkbox"
        id="showPICCheckbox"
        style="accent-color: red; margin-right: -10px"
      />Show PIC
    </div>
  </div>
</body>

<!-- Script untuk interaktivitas -->
<script>
  let base64PDF = "";
  let base64PNG = "";
  let infoLE = "";
  let infoYTD = "";

  fetch("CustomInfo.txt")
    .then((response) => response.json()) // parsing sebagai JSON
    .then((data) => {
      // Ambil nilai Base64 dari field JSON (misalnya data.base64)
      base64PDF = data.PDF;
      base64PNG = data.PNG;
      infoLE = data.LE;
      infoYTD = data.YTD;

      document.getElementById("PeriodeText").innerHTML = infoLE;

      // Buat URL Data dengan prefix MIME type
      const pdfDataUrl =
        "data:application/pdf;base64," +
        base64PDF.trim() +
        "#view=FitH&toolbar=0&navpanes=0&statusbar=0";
      const pngDataUrl = "data:image/png;base64," + base64PNG.trim();

      // Tampilkan di iframe
      document.getElementById("DetailCSC").src = pdfDataUrl;
    })
    .catch((error) => {
      console.error("Gagal memuat CustomInfo.txt:", error);
    });

  // Fungsi untuk menyesuaikan skala tampilan berdasarkan ukuran layar
  function scalePage() {
    const baseWidth = 1366;
    const baseHeight = 768;
    const scaleX = window.innerWidth / baseWidth;
    const scaleY = window.innerHeight / baseHeight;
    const scale = Math.min(scaleX, scaleY);

    document.getElementById("chartLatestEstimate").style.display = "block";
    document.getElementById("wrapper").style.transform = `scale(${scale})`;
  }

  window.addEventListener("resize", scalePage);
  window.addEventListener("load", scalePage);

  function PilihChart() {
    const PeriodeText = document.getElementById("PeriodeText");
    const sortScoreCheckbox = document.getElementById("sortScoreCheckbox");
    const menuSelect = document.getElementById("menuSelect");
    const analyzeButton = document.getElementById("analyzeButton");

    const currentMonth = document.getElementById("chartCurrentMonth");
    const latestEstimate = document.getElementById("chartLatestEstimate");
    const detailCSC = document.getElementById("DetailCSC");
    const currentMonthUnsort = document.getElementById(
      "chartCurrentMonthUnsort"
    );
    const latestEstimateUnsort = document.getElementById(
      "chartLatestEstimateUnsort"
    );

    const LabelTheme = document.getElementById("LabelTheme");

    currentMonth.style.display = "none";
    latestEstimate.style.display = "none";
    currentMonthUnsort.style.display = "none";
    latestEstimateUnsort.style.display = "none";
    LabelTheme.style.display = "none";
    sortScoreCheckbox.style.display = "flex";
    showPICCheckbox.style.display = "flex";

    detailCSC.style.display = "none";
    analyzeButton.style.display = "none";

    if (menuSelect.value === "current-month") {
      PeriodeText.innerHTML = infoYTD;
      if (sortScoreCheckbox.checked) {
        currentMonth.style.display = "block";
      } else {
        LabelTheme.style.display = "flex";
        currentMonthUnsort.style.display = "block";
      }
    } else if (menuSelect.value === "latest-estimate") {
      PeriodeText.innerHTML = infoLE;
      analyzeButton.style.display = "block";
      if (sortScoreCheckbox.checked) {
        latestEstimate.style.display = "block";
      } else {
        LabelTheme.style.display = "flex";
        latestEstimateUnsort.style.display = "block";
      }
    } else {
      detailCSC.style.display = "block";
      sortScoreCheckbox.style.display = "none";
      showPICCheckbox.style.display = "none";
    }
  }

  // Fungsi untuk menangani pemilihan chart
  menuSelect.addEventListener("change", PilihChart);
  sortScoreCheckbox.addEventListener("change", PilihChart);

  // Checkbox untuk menampilkan PIC
  const showPICCheckbox = document.getElementById("showPICCheckbox");
  showPICCheckbox.addEventListener("change", function () {
    const picIframe = document.getElementById("PICCSC");
    document.addEventListener("click", (e) => {
      // Offset sedikit supaya tidak tepat di bawah kursor
      const offsetY = 20;
      picIframe.style.top = `${e.pageY + offsetY}px`;
    });
    picIframe.style.display = this.checked ? "block" : "none";
  });

  // Deteksi perangkat dan set iframe DetailCSC sesuai device
  window.addEventListener("load", function () {
    const iframe = document.getElementById("DetailCSC");
    const userAgent = navigator.userAgent.toLowerCase();

    const isMobile =
      userAgent.includes("mobile") ||
      userAgent.includes("android") ||
      userAgent.includes("iphone");

    // Gunakan data-src jika mobile, atau src jika desktop
    iframe.src = isMobile
      ? iframe.getAttribute("src")
      : iframe.getAttribute("src");
  });

  analyzeButton.addEventListener("click", function () {
    // Nonaktifkan tombol dan ubah tampilannya
    analyzeButton.disabled = true;
    menuSelect.disabled = true;
    analyzeButton.textContent = "Processing...";
    analyzeButton.style.cursor = "wait";
    analyzeButton.style.opacity = 0.5;

    const width = 900;
    const height = 700;
    const left = (screen.width - width) / 2;
    const top = (screen.height - height) / 2;

    // Tambahkan delay 2 detik sebelum membuka window
    setTimeout(() => {
      const analyzerWindow = window.open(
        "analyzer.html",
        "AnalyzeCSCWindow",
        `width=${width},height=${height},left=${left},top=${top},resizable=no,scrollbars=yes,toolbar=no,menubar=no,status=no,location=no`
      );

      // Pantau apakah window sudah ditutup
      const windowCheckInterval = setInterval(() => {
        if (analyzerWindow.closed) {
          clearInterval(windowCheckInterval);

          // Kembalikan tampilan tombol
          analyzeButton.textContent = "Analyze";
          analyzeButton.disabled = false;
          menuSelect.disabled = false;
          analyzeButton.style.cursor = "pointer";
          analyzeButton.style.opacity = 1;
        }
      }, 500); // Cek setiap 500ms
    }, 2000); // Delay sebelum membuka window
  });
</script>
